{% macro render(result) -%}
  <article>
    <details open>
      <summary class="none">
        <div class="row">
          <div class="max">
            <h5>{{ result.therapy.name }}</h5>
          </div>
          <i>arrow_drop_down</i>
        </div>
      </summary>
      <h6>Variant description</h6>
      <p>HGVS: <a class="link" target="_blank" href="https://mutalyzer.nl/normalizer/{{ result.therapy.hgvs}}">{{ result.therapy.hgvs }}</a></p>
      <h6>Therapy description</h6>
      <p>{{ result.therapy.description}}
      <h6>Annotation overview</h6>
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Remaining</th>
            <th>Basepairs</th>
            <th>Percentage</th>
          </tr>
        </thead>
        <tbody>
          {% for comp in result.comparison %}
          {% set value = (comp.percentage * 100) | round(precision=1) %}
          <tr>
            <td>{{ comp.name }}</td>
            <td>{{ value }}% </td>
            <td>{{ comp.basepairs }}
            <td><progress value="{{value}}" max="100"></progress></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </details>
  </article>
{%- endmacro %}
{% if results is defined %}
  <div id="results" class="page padding active">
    <h2> Analysis results for {{ variant }}</h2>
      <p> This section contains the predicted transcript based on the input variant(s).</p>
      {% set result = results.input %}
      {{ render(result) }}
    <h2>Variant-modifying therapies</h2>
    <p>This section contains analysis results for therapies which directly modify or remove the specified input variants.</p>
    {% for result in results.modified %}
      {{ render(result) }}
    {% endfor %}
    <h2>Other therapies</h2>
    <p>This section contains therapies which do not directly change any of the specified input variants.</p>
    {% for result in results.all %}
      {{ render(result) }}
    {% endfor %}
  </div>
{% else %}
  <div id="results" class="page padding">
    <h5> Analysis results for {{ variant }}</h5>
    Please specify a variant to analyze.
  </div>
{% endif %}
